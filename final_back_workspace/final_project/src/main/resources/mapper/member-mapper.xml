<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.or.iei.member.model.dao.MemberDao">

	<!-- 아이디 중복체크 -->
	<select id='chkMemberId' parameterType='string'>
	select count(*) from tbl_member where member_id = #{_parameter}
	</select>
	
	<!-- 이메일 중복체크 -->
	<select id='chkMemberEmail' parameterType='string'>
	select count(*) from tbl_member where member_email = #{_parameter}
	</select>
	
	<!-- 회원가입 -->
	<insert id='insertMember' parameterType='Member'>
	insert into tbl_member values (
		to_char(sysdate,'yymmdd') || lpad(seq_member.nextval, 4,'0'), #{memberId}, #{memberPw}, #{memberName}, #{memberEmail},
		#{memberPhone}, default, default, default, default, default, default, default, default, default, default
	)	
	</insert>
	
	<!-- 로그인 -->
	<select id='memberLogin' parameterType='string' resultType='Member'>
	select member_id memberId,
		   member_pw memberPw
	  from tbl_member
	 where member_id = #{_parameter}
	</select>
	
	<!-- 회원 1명 조회 -->
	<select id="selectOneMember" parameterType="String" resultType="Member">
		select member_id as memberId,
			   member_pw as memberPw,
			   member_name as memberName,
			   member_email as memberEmail,
			   member_phone as memberPhone,
			   is_admin as isAdmin,
			   enroll_date as enrollDate,
			   can_comment as canComment,
			   overdue_day_count as overdueDayCount,
			   borrowed_book_count as borrowedBookCount,
			   max_borrow_count as maxBorrowCount,
			   can_borrow as canBorrow,
			   cant_borrow as cantBorrowDay,
			   no_lent_count as noLentCount,
			   can_request as canRequest
			   from tbl_member where member_no = #{_parameter}
	</select>
</mapper>
